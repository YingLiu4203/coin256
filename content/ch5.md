# 不对称的防御能力

本书开头提到普通人抛265次硬币就可以得到信息与财产自由。本章解释背后的数学原理。

## 1 技术分权

技术的真正意义，不仅在于提高效率，更在于重组权力。在人类历史上，技术的出现往往伴随着权力的转移。有些技术让权力集中，有些则让权力分散。而每一次分权，都会带来个人自由的一次跃升。

第一次真正释放个体力量的技术，是十五世纪的印刷术。那时的知识稀缺而昂贵，文字掌握在神职人员和贵族手中。人们若想接触思想，就必须依附于宗教或权威。当古腾堡的印刷机开始运转，世界悄悄地改变了。书籍可以被大量复制，思想可以被广泛传播，个人第一次拥有了绕过权威去说话的机会。印刷术让知识走出了修道院，也让人走出了沉默。它不仅改变了文化传播的方式，更改变了社会结构，人开始自己阅读《圣经》，自己判断真理。宗教改革、启蒙运动、科学革命，都是这场分权运动的延续。印刷术把“表达的权力”从少数人手中交还给了每一个愿意思考的人。

五百年后，人类又一次陷入权力的集中。这一次的中心不在教会，而在信息服务器。人们的通信、财产、身份都被数字化，而控制这些数据的，不是牧师，而是平台和算法。人们依旧可以说话，但被算法决定能被谁听见；依旧可以拥有财产，但财产只是数据库中的数字；依旧有身份，却依附在系统发放的账号之下。

在这种背景下，加密技术的出现有了新的意义。它不只是计算机科学的进步，而是一种自由的再分配。加密让人们重新拥有了信任自己与他人的能力，人们可以用自己的密钥保护通信，用自己的签名证明身份，也可以存储和转移价值，而不依赖任何机构。加密学孕育了一种新的启蒙，它教人不再把信任寄托于权威，而是依赖于坚实的数学理论与公开的加密算法，让个人重新成为自己世界的中心。而这正是信息时代新的分权革命的开始，它不以暴力为手段，不以政治为旗帜，而以代码为语言，以数学为契约，在安静而深远的层面上，重新定义了和赋能了自由这个古老的词。

## 2 密码学素养

在所有人都关心都会涉及的信息安全领域，密码学就像识字：你不必成为语法学家，才能读写；但若连字母都不认，许多权利只能“听别人念给你听”。使用智能手机不需要成为电子或软件工程师，同样地，使用加密来创建数字身份、保护隐私也不需要数学学位。然而，懂得一些最基本的密码学概念——例如“私钥像印章且不可外借、公钥是可公开的名片、数字签名是可验证的承诺、哈希是内容的指纹、随机性与备份是安全的底座”——会带来三个层面的收益：第一，你能把信任从“相信”升级为“可验证”，知道系统到底在向你承诺什么以及背后的机制；第二，你能在关键节点做对选择：该不该分享一段信息、为何要备份密钥；第三，你能识别并拒绝社会工程与伪装的“好意”，明白“不是你的密钥，就不是你的资产”。基础密码学素养并非技术崇拜，而是一种自由的素养。它让个体知道自由的边界在哪里、可撤回的路径在哪里、哪些安全是系统替你完成的、哪些决定只能由你来下。正如交通规则让驾驶变得安全顺畅，基本的密码学常识让“把复杂交给系统，把确定还给人”真正落地。

密码学听上去像高等数学，其实也确实比较复杂和抽象。幸运的是作为用户其实要掌握的基本概念非常少，也不需要微积分或抽象代数。会加减乘除、有概率的直觉（像一百万次里也难蒙中）、能读懂几句比喻，就足以把它用在自己的身份、通信与财产上，而且这种收益会在此后许多年持续“复利”。你真正需要懂的，就这几个观念

- 随机性 = 地基：强随机数让计算机也难以被猜中；
- 密钥 = 钥匙：加密解密用的钥匙。
- 加密 = 上锁密封：用密钥和算法把“明文”变成“密文”，让没有密钥的人看不懂。
- 解密 = 用锁解封：用密钥和算法把“密文”变成“明文”，让有密钥的人看的懂。
- 哈希 = 内容指纹：把任意内容压成一小串“指纹”，相同内容指纹必然相同、改一字指纹全变。
- 私钥 = 印章：只在你手里、不能外借；所有重要动作（转账、授权、登录）都要“盖章”才算数。
- 公钥 = 名片：可以公开给任何人，可以用对应的私钥用来验证此公钥的所有者。
- 数字签名 = 可验证的承诺：别人拿到你的“章迹”，能验真伪、看是否被改过。

## 3 随机性

随机性是指不可预测性，越是不可以预测的事物随机性就越强。随机数就是不可预测的数字序列。加密、解密、消息编号、口令存储、数字签名都很多地方都需要用到随机数。比如加密解密用到的密钥越随机，别人就越不可能“配出同样的钥匙”。信息安全的第一步通常是生成随机数，而随机数的不可预测性决定了信息安全的程度。人们为此大费周章也不足为奇了。

如果你有机会走进互联网内容服务商 Cloudflare 公司旧金山总部的大厅，第一眼可能不是前台，而是一整面发着温暖光晕的熔岩灯墙。大小不一的蜡团在玻璃管里慢慢升腾、分裂、汇合，像一面流动的星图。对来访者来说它只是漂亮；对这家公司来说，它是“互联网的守门人”。天花板上方有一台镜头，持续拍摄这面墙，把每一帧里不可预测的细节——蜡团的形状、灯光的闪烁、甚至人群经过投下的阴影柔和起来提炼为“熵”（熵支不确定性），再喂给密码学安全随机数发生器，去增强网站连接和密钥生成的随机性。如果你恰好站在这面墙前，挥挥手、走过灯影，你的动作也会被相机“抓住”，成为那一瞬间随机性的组成部分。任何人都无法预言下一滴蜡会怎样拧、往哪里飘。正因为这种微观的不确定，互联网每天无数次握手的安全，得以多一层“来自现实的背书”。

![Lava light](./imgs/ch5_lava.jpg)
[Source: Wikipedia Lavarand](https://en.wikipedia.org/wiki/Lavarand)

普通人当然不太可能建这样一堵墙来获得有足够强度的随机性。其实有更简单的办法，虽然有点费时，但是随机性可以媲美熔岩墙。答案就来自足球比赛转播里常见的一幕：两支球队开赛前，要用抛硬币决定谁先开球。硬币在空中不停翻转，落地只会是正面或反面。这个小小的仪式有一种朴素的力量：在它落地之前，没人知道结果。这种不可预知，正是“随机性”。如果把“正面”记作 1、“反面”记作 0，一次公平的抛掷就给出一个二选一的答案。在信息的语言里，这份“是/否”的不确定量叫作 1 比特：像一盏小小的开关，只能开或关，却确实装下了一点“未知”。

![Coin Toss](./imgs/ch5_toin_toss.jpg)
[Source: Wikipedia Coin Flipping](https://en.wikipedia.org/wiki/Coin_flipping)

如果你不止抛一次，而是连续抛 256 次，把每次的结果依次写成由 0 和 1 的组成的长串。你得到的，不再是一盏开关，而是一整排 256 个小开关的组合，这就是 256 比特的随机数。它有多少种可能？答案是 2 的 256 次方，写成十进制约是 1 后面跟 77 个零。如果你觉得大得难以想象，你是对的，因为这个数字接近可观测宇宙里的原子总数。

这意味着什么？假如有台性能夸张到离谱的机器，每秒能试出 10¹⁸ 个候选密钥（万亿次中的万亿次），并且从宇宙大爆炸开始就不眠不休地算到今天（约 4×10¹⁷ 秒），它也只来得及试 10³⁵ 个组合。和上述可能性相比，连海边的一粒沙都算不上。换句话说，靠暴力穷举去猜中那串 265 次抛掷的结果，在物理上几乎不可能。因此，用这串位作为密钥或产生密钥的种子，等于给自己锻造了一把几乎不可能被复制的钥匙。从这里开始，隐私与信任不再只是口头的承诺，而是可验证、可执行的技术事实；而那份由个人亲手掷出的随机性，正是个人在数字世界里主权的地基。
