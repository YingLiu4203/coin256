# 比特币的实现

## 1 比特币是一个公共账本

比特币的革命性本质常常被误解，人们常常用“加密哈希”或“去中心化共识”等复杂的科技术语来描述它。然而，比特币的核心理论突破其实极其简单且古老：它解决了创建通用公共账本的问题。将比特币与上面提到的雅浦岛莱石货币进行比较，可以最优雅地阐释这一概念。与莱石一样，比特币真正的创新之处而在于其作为透明、共享且不可篡改的公共所有权记录的功能。在雅浦岛用莱石货币进行支付时，所有权的转移并非通过移动沉重的石头本身（有些重达数吨），而是通过社区的认可来实现的。因为社群拥有一个公认、集体认可且口头记录的所有权归属的公共账簿，莱石所代表的货币的所有权就有全体共识。从本质上讲，比特币是雅浦传统的数字化继承者。它并非交易的“硬币”，而是在名为公共账本上留下的永久记录。当用户发送比特币时，他们并非将数字比特从一个地方转移到另一个地方，而是向全球节点网络（社区）广播一条签名指令，以更新公共账本。整个网络必须验证并同意这一变更，从而确保账本的更新过程透明公开，人人可见。这一过程取代了传统金融体系对不透明的私有账本（例如银行维护的账本）的依赖，取而代之的是一个通用且可公开验证的账本。这种转变是主权货币的根本基础：如果每个人都能看到账本，任何机构都无法秘密篡改历史记录或所有权记录。

由于数字信息本身易于完全的复制（就像在计算机上复制文件一样），所有数字货币的根本挑战是必须克服双重支付问题。双重支付指的是同一枚数字货币可能被同一人多次使用的风险，这实际上允许他们复制或伪造货币。传统的数字支付方式依赖于中心化机构（例如银行）维护一个私有的中央账本，以验证每一笔交易并防止同一笔资金被重复使用。去中心化的比特币通过创建公共的全球分布式账本解决了这个问题，而无需信任任何第三方。这里的分布式账本（distributed ledger）是指每个比特币节点都有一个完整的相同账本，而不是账本的各个部分在分布在不同节点。这相当于整个雅浦村村民聚集在一起确认莱石所有权发生的所有变更（交易）并记在每个人的脑子里，稍后会介绍实现这种账本一致性的共识机制。

## 2 账户

比特币承诺的个人货币主权的核心要素在于账户本身的开放性和易用性。与需要身份验证、填写表格并获得金融机构许可的传统银行不同，比特币账户仅仅是一个公钥，它源自一个秘密的私钥。严格来说，比特币账户是公钥的哈希值。由于一个公钥的哈希值是固定的而且从哈希值无法反推出原来的公钥，这其实增加了一层安全性。从用户角度可以把这个公钥就看成是个人的比特币账户，是一串由数字和字母组成的加密字符串，任何人都可以使用开源软件立即单方面生成，无需任何政府或银行的批准。由于比特币网络是完全开放的，因此世界上任何人，无论国籍、信用评分或法律身份如何，都可以创建一个地址并立即开始接收资金。然后，该地址会在公共账本上用于接收交易。使用该网络的唯一要求是拥有私钥，它是所有权的秘密数学证明。这种优雅的设计使货币网络的访问更加民主化，确保该系统完全开放、全球可访问，并且真正能够抵御审查或歧视。

## 3 交易

交易就是比特币的所有权转让。由于比特币账本记录了所有的交易，所以每个交易里的每个接收方的数额是可验证的。实际操作上，比特币交易是拥有者指示网络重新分配以前收到的比特币的公开记录。转账其实是在签署和广播一条消息，该消息指定一个或多个先前收到比特币的交易，同时指定一个或多个新的接收地址，将这些资金分配给这些接收地址。这使得多笔交易可以同时向多个地址发送资金。例如，向两个不同的商家付款，并将余额退回到发送者指定的一个新地址。出于安全考虑，余额通常放入一个新生成的公钥地址。为了激励比特币网络节点将交易安全地记录，每笔比特币交易都必须包含交易费。该费用是输入总价值与输出总价值（付款资金和付款方保留的余额）之间的差额。剩余部分由成功验证包含该交易的区块的网络节点获得。用户可以调整此费用，以优先处理他们的交易,较高的费用通常可确保更快的确认。从本质上讲，比特币交易是记录在公共账本上的一个公开声明，通过密码学保护，它定义了比特币的所有权转让，同时补偿网络运营节点的服务费用。

具体实现上，比特币网络的运行机制与传统银行体系有着根本的不同，它摒弃了账户余额的概念。比特币依赖于未花费交易输出UTXO（Unspent Transaction Output）模型。该模型对于确保所有权的加密证明、防止双重支付以及维护公共账本的不可篡改性至关重要。理解比特币交易需要将其视为一个独立的会计条目，该条目会消耗和创建这些UTXO，并受严格的输入输出结构和嵌入式费用机制的约束。

### 3.1 未花费交易输出（UTXO）

UTXO 是比特币生态系统中的基本操作单元。关键在于，UTXO并非货币单位，而是记录了在先前交易中收到的特定数量的比特币，这些比特币尚未在后续交易中作为输入被消耗。简单来说，如果用户拥有 0.5 个比特币，网络并不会在其账户中追踪一个单独的 0.5 个比特币余额；相反，用户的总余额是其当前可花费的所有 UTXO 的总和。例如，这 0.5 个比特币可能由三个独立的 UTXO 收到的数量组成：0.1 个比特币、0.15 个比特币和 0.25 个比特币，每个 UTXO 都是一个不同的历史交易。这些独立的UTXO 在新的交易中使用时必须全部消耗掉，也就是一个 UTXO 只使用一次，所以其名字是未花费的交易：一旦使用（花费），就无效了。UTXO 模型提供了加密的清晰性和稳健性，因为网络中的每个交易都可以追溯到其创建点，而且只可以使用一次，从而消除了关于其存在性和所有权状态的歧义。

### 3.2 交易构建：输入、输出和找零

一笔新的比特币交易由一个或多个现有的、未花费的 UTXO 作为输入构成。要花费资金，用户需要提供解锁这些特定 UTXO 所需的加密证明（由其私钥生成的数字签名）。交易构建的基本规则是，所有输入的总价值必须严格大于预期的支付金额，差额是交易费。交易随后定义一个或多个输出，这些输出本质上是为接收方创建的新 UTXO。由于每个作为输入的每个 UTXO 只能使用一次，其中的比特币都必须被完全消耗，因此输入的总价值减去支付金额得到的差额不会被简单地保留而自动成为交易费。对于要保留的资金，发送方必须将多余的金额分配回其控制的一个新地址：这被称为找零输出。为了增强交易隐私，这笔找零通常会发送到一个新生成的公钥地址。基本的记账原则仍然不变：消耗的输入必须恰好等于创建的输出加上交易手续费。

### 3.3 计量单位与激励机制：聪与手续费

比特币网络中的所有价值，包括输入金额、接收方输出金额和找零金额，均以聪（satoshi）为单位。聪是比特币的最小单位，代表一亿分之一的比特币（$1 BTC = 100,000,000 sats$）。所有价值均使用聪的大整数进行跟踪和计算，以保持精度并避免浮点误差。交易的最后一个组成部分是交易手续费。该手续费并非指定的输出，而是剩余价值：输入金额的总和减去所有显式输出（接收方和找零）的总和。这部分剩余金额故意不予分配，由成功验证包含该交易的比特币网络节点收取，作为通过工作量证明机制保障网络安全的经济激励。发送方通过管理输入和输出之间的差异来设定其有效手续费率，从而根据其需要确认交易的速度来竞争区块空间。

### 3.4 区块与 Coinbase 块基交易

比特币网络由数万个节点构成，所有的交易需要发送到所有节点并且最后需要统一确认其有效性与一致性，因此不可能一笔一笔处理交易。区块（block）存在的主要目的是为了通过批量处理提高效率和安全性。它并非将每笔交易立即添加到公共账本（这样做会造成混乱且消耗大量资源），而是将交易打包成一个单一的、统一的数据结构，即区块。区块是比特币网络数据存储与验证的基本单位。Coinbase 是每个比特币区块中的第一笔交易，本书翻译为块基交易。块基交易至关重要，因为它是新比特币进入流通供应的唯一方式。

与其他所有消耗现有未花费交易输出 (UTXO) 作为输入的交易不同，块基交易没有输入。相反，它承担着两个关键功能：区块奖励与区块标识。区块奖励由区块补贴与交易手续费两部分组成。区块补贴是新铸造的比特币，初始数量为 50 BTC，大约每四年减半。这是所有新比特币的来源。交易手续费则是该特定区块中包含的所有交易支付的手续费的总和。成功解决工作量证明难题的节点可以创建此交易，并将总奖励（补贴 + 手续费）作为输出发送到他们选择的比特币地址。区块标识是块基交易的输入字段（通常为空），用于存储网络节点选择的任意数据。节点有时会使用此字段公开标识自身，或者在历史上，用于嵌入简短消息或时间戳，作为区块的唯一标识符，并以此表明对区块内容的承诺。块基交易是协议内置的网络安全资金机制。它向成功完成区块验证的节点支付报酬，将经济激励与区块验证过程直接挂钩。

### 3.5 区块链

比特币的巨大成功催生了一个无处不在却又常被误解的术语：区块链（blockchain）。讽刺的是，中本聪最初发布的九页白皮书《比特币：点对点电子现金系统》中，从未出现过区块链这个单一而又意义深远的词汇。相反，中本聪选择了一种功能性的描述：区块的链（chain of blocks）。中本聪刻意选择强调功能而非抽象概念，重点放在了技术流程上：区块是经过验证的数据单元，而链则是防止双重支付并确保时间顺序的加密连接。这种功能描述对于比特币的理念至关重要，因为它将人们的注意力引向工作量证明（PoW）机制和最长链规则，这些机制是实现共识的保障。早期，比特币协议被视为一种基于“时间链”或“分布式公共账本”的“数字现金”技术创新，这种说法将这项发明定义为货币领域的突破，而链结构仅仅作为货币的安全机制。

区块链的英文 “blockchain” 作为单独的名词发生在后期，主要是因为企业和金融机构试图在不接受比特币激进的政治和货币原则的情况下，利用其底层的分布式账本技术。在比特币证明了分布式账本技术的稳健性之后，企业意识到其可以应用于供应链管理、投票系统和私人银行联盟等有领域，这其实是一种误用。后面会详细讨论这个话题。

此处用区块链是一种链式数据结构的本意。区块是批量存储交易的容器，而链是连接这些区块的组织方式，旨在无需依赖中央管理者即可保证记录所有交易的账本的完整性和永久性。链结构的主要目的是创建一个完整、可验证且不易篡改的历史。每个新区块一旦经过验证并添加到网络中，其头部就包含一个关键信息：紧邻其前一个区块的加密哈希值。该哈希值是一个独特的数字指纹，源自前一个区块的所有数据。如果前一个区块（或其中的任何交易）中的任何一个字符发生更改，其哈希值将完全改变。因此，当前区块头部存储的哈希值将不再与前一个区块的哈希值匹配，从而立即使整个后续链失效。

![block chain](./imgs/ch8_block_chain.jpg)

这便形成了一种数字化的链条：每个区块都锁定了其之前所有区块的时间顺序和交易历史记录。如果恶意行为者试图篡改五年前的一笔交易，他们必须先成功重新计算出该旧区块的正确哈希值，然后重新计算出此后添加的每一个区块的有效哈希值，由于系统的工作量证明安全机制（后面会介绍），这在计算上是不可能的。由于链的重建的成本极其巨大，因此区块链成为一个仅可追加的账本。在区块链末尾添加一个新的有效区块极其容易，但重写历史，即试图通过重组其后的区块来撤销现有交易的成本需要重做其后的所有工作量证明并得到多数节点认可是几乎不可能完成的任务。因此，区块链结构提供了一种优雅的解决方案，它通过一条不可破解的加密证明链，将网络中的每一笔交易都追溯到第一个的创世区块，从而建立了一条全球认可且不可更改的所有权时间线。

### 3.6 创世区块 The Genesis Block

创世区块是比特币区块链的第一个区块，也就是第零个区块，它占据着一个独特的地位，超越了其作为网络起点的功能性角色。创世区块由中本聪于 2009 年 1 月 3 日创建，它确立了整个货币体系的核心参数，并在其中嵌入的隐藏信息，这既是比特币的奠基宣言，也是其政治评论。创世区块在技术上是独一无二的，因为它是区块链中唯一一个不引用前一个区块的区块。每个后续区块都使用前一个区块的哈希值链接回其父区块，但创世区块的前一个区块哈希值字段则填充为零。这使创世区块成为了一个永恒不变的锚点，所有后续历史和未来的工作量证明安全机制都由此衍生而来。尽管该区块包含了首笔 块基交易（由此产生了最初的 50 个比特币补贴），但由于代码中的一个缺陷，这些原始比特币永久无法使用，仅作为区块创建的证明，从未进入流通。这种技术上的异常强化了该区块作为基石的象征性地位，而非活跃账本的一部分。

创世区块的一个有趣之处在于中本聪选择写入块基交易作为区块标识的文字：“《泰晤士报》2009年1月3日头版头条：财政大臣即将对银行进行第二次救助。” 这条信息摘自英国《泰晤士报》当日的头版头条，既是时间戳，也是一份强有力的哲学宣言。它将比特币的诞生与全球金融危机永久地联系起来，使这种去中心化货币不再仅仅被视为一种技术奇观，而是对中心化、基于信任的金融机构失败的直接且有原则的回应。通过嵌入这条特定的头条新闻，中本聪将创世区块塑造成一个无可争议的起点，开启了一个基于密码学证明而非机构信仰的替代货币体系。

本质上，创世区块是比特币的“白板”，也是它的政治宣言。它确立了网络规则（初始补贴、区块结构），并提供了第一个不可伪造的存在证明。更重要的是，嵌入的信息定义了系统的核心目标：构建一个分布式、抗审查的金融体系，以替代被认为脆弱且依赖政府持续干预的金融体系。

## 4 比特币的共识机制：工作量证明 PoW（Proof of Work）

比特币的运行完全依赖于其共识机制，这是一套密码学算法和经济学规则，利用竞争性博弈论确保所有参与者（网络节点）对交易历史的唯一正确版本达成一致。基于工作量证明 PoW（Proof of Work）的共识机制同时解决了三个关键问题：验证新交易、定义将新交易添加到公共账本的过程，以及保护网络免受欺诈活动的影响。

比特币共识机制是一个有计划的、竞争性的程序，旨在确保公共账本的安全，并就全球范围内唯一有效的交易历史记录达成一致。该过程始于矿工将待确认的、未确认的交易收集到一个候选区块中，目标是达到最大数据容量。核心挑战是工作量证明 PoW，这是一个资源密集型的密码学难题，要求矿工反复对区块头进行哈希运算，直到找到符合网络难度目标的结果。这种暴力破解的难度经过精心调整，使得网络平均每十分钟生成一个有效区块。第一个获得此证明的矿工将赢得广播新区块的权利，同时获得区块奖励和所有交易手续费，作为维护网络安全的经济激励。新区块广播后，所有网络节点都会严格按照核心验证规则进行检查，以确保所有交易在密码学上有效，未被双花（UTXO完整性），并符合货币协议的限制。由于两个矿工有时可能几乎同时解出难题，导致临时分叉，网络会使用最长链规则来解决冲突。该规则规定，所有参与者必须认可并基于累计工作量证明最多的链进行构建——这条链代表着最大的计算能量消耗。通过只接受最长、最难重建的链，网络保证最终收敛于单一且不可篡改的交易历史，从而保障公共账本的完整性。下面是相关概念的简要说明。

### 4.1 节点和矿工

比特币网络由两种截然不同的角色保障安全：节点（node）和矿工（Miner）。

节点是指运行比特币软件并持有完整、独立验证的区块链历史记录副本的任何计算机。节点是网络的验证者和规则执行者。它们被动地监控所有传入的交易和提议的区块，检查每一条规则：确保只有正确的（未被使用的） UTXO 被花费，验证加密签名，并确认区块的工作量证明解决方案符合难度目标。如果矿工提议的区块无效，节点会拒绝它，从而保护网络的完整性，并确保即使是最强大的矿工也无法破坏协议规则。

矿工是一种特殊的节点，负责执行工作量证明 PoW 中耗费大量能源的主动工作。矿工收集已验证的交易，将它们打包成一个区块，然后通过暴力哈希竞赛来寻找所需的加密解决方案。它们的功能是创建并提议新的区块供网络验证。矿工的动机完全来自经济激励通过 Coinbase 交易支付的区块奖励（补贴 + 交易费），这使得他们的自身利益与公共账本的安全保持一致。

### 4.2 区块验证

在生成区块时，矿工必须根据严格的规则对其进行严格验证以保证运行相同规则检查的其他节点不会拒绝这个新区块。这些验证规则确保数据的完整性：

- 语法有效性：区块格式必须符合网络的技术标准。
- 交易有效性：区块中的每笔交易都必须单独有效。这包括检查输入（UTXO）是否存在、是否被双花，以及是否附有合法所有者（私钥）的正确加密签名。
- 金额限制：用于生成矿工奖励的区块交易（Coinbase）不得超过当前协议限额（区块奖励加上交易费用）。
- 工作量证明：最关键的是，区块头必须包含有效的加密工作量证明，该证明将新区块与其前一个区块安全地链接起来。

### 3.4.2 工作量证明流程

工作量证明（PoW）是一种竞争性且资源密集型的过程，又称挖矿，矿工通过这种方式证明他们已投入计算资源来创建区块。这种竞争是抵御网络攻击的主要防御手段。矿工收集一组有效的、未经确认的交易，并将它们聚合到一个候选区块中。接下来的挑战是为该区块生成一个有效的哈希值。为了被认为是有效的，生成的哈希值必须以预定数量的零开头，这个条件被称为目标难度。

![mining](./imgs/ch7_mining.jpg)

由于哈希函数是确定性的且不可逆的，矿工生成满足此难度目标的哈希值的唯一方法是反复修改区块头中的一个任意数字，称为随机数（nonce）。这实际上是一个暴力破解式的猜测过程：矿工反复修改随机数，重新对整个区块头进行哈希运算，并检查输出结果是否满足难度目标。这种成本高昂的试错过程需要大量的电能和专用硬件。第一个找到能产生有效哈希值的 nonce 的矿工将赢得向网络广播其新区块的权利，收取交易费和区块补贴，从而执行保护公共账本的核心服务。

### 4.3 冲突解决：最长链规则

由于挖矿是一个同时进行的竞争过程，两个不同的矿工有可能几乎同时找到一个有效的区块。这会导致临时分叉，两条不同的历史记录版本同时添加到链的同一高度。网络使用最长链规则来解决这种冲突。

当一个节点收到两个有效的、相互竞争的区块时，它会暂时持有这两条链。然后，它会等待下一个区块被挖出。为了获得最稳定、最有利可图的链，矿工总是会选择在他们最先收到的链上构建新的区块。一旦另一个区块被成功挖出并附加到其中一条竞争链上，该链就成为“最长链”，并被网络接受为唯一的真实来源。较短的、现在已被弃用的链上的交易将被退回到未确认池，而创建“孤儿区块”的矿工将失去其奖励。这条规则确保诚实且资源充足的矿工始终在积累了最多计算工作的链上进行建设，从而保证最终收敛到单一的、全球公认的历史记录。

## 5 比特币的设计理念

了解了比特币的运行原理就可以更好地理解其背后的设计理念。比特币的主要设计理念可以概括为：简洁、开放与主权。比特币协议的持久力与可靠性源于其以简洁性和易用性为核心的深刻设计理念。中本聪精心打造了一个系统，旨在使其从根本上开放、可检查，并允许任何拥有标准计算机的人执行，从而确保其运行参数能够直接实现去中心化、主权货币的核心目标。而比特币真正的韧性不仅源于其密码学算法，还依赖于一套固定且不可协商的共识协议参数，这些参数共同维系着比特币的运行。这些参数定义在协议的源代码中，融合了技术、博弈论和货币政策，构建了一个自我调节、可预测且去中心化的金融体系。它们决定着网络的运行时间、最终的货币供应量以及交易过程的经济机制。

## 5.1 简洁、开放和低准入门槛的原则

比特币的理念基于这样的假设：如果一个货币系统过于复杂，就需要专业知识和权威机构的参与，这会立即违背去中心化的初衷。因此，其设计优先考虑两个关键要素：开源透明性和低参与门槛。每一行定义协议规则的代码都可公开审计，任何有基本编程知识的人都可以检查其逻辑，并验证是否存在任何隐藏机制。更重要的是，该系统旨在允许任何人运行一个完整的节点，所需的只是一台能够下载并验证完整交易历史的普通个人计算机。运行一个节点所需的计算资源被刻意控制在最低限度，确保全球各地的个人都能作为独立的规则执行者参与其中，而无需使用专业且昂贵的硬件。这种简洁性使得该网络无需许可且抗审查，如果规则足够简单，能够被普遍理解且易于验证，那么任何单一实体都无法秘密更改规则或阻止系统运行。

为了去中心化设置的低准入门槛也是很多人容易忽略的一个特点。这是理解比特币设计的关键所在：低交易吞吐量是其优先考虑去中心化的核心理念，而非最大化交易速度的直接且刻意的结果。由此导致的每秒约 7 笔交易（TPS：Transactions Per Second）的限制并非技术缺陷，而是为了确保网络保持开放性和抗审查性而必须做出的基础性权衡。比特币的网络节点是规则执行者，它下载并验证整个区块链历史记录，确保每笔交易和区块都符合协议的既定规则，例如 2100 万枚比特币的供应上限以及 UTXO 模型的正确应用。如果运行全节点需要庞大的数据中心或难以承受的带宽，那么验证网络的能力就会集中在少数富裕实体手中，从而重新引入比特币旨在克服的中心化问题。因此，系统的简洁性是其政治韧性的关键，确保了验证节点的最大参与度和地域分布。

## 5.2 稀缺性货币政策

比特币的一个关键设计是其稀缺性原则。比特币总发行量的数学上限为 2100 万枚比特币。这种固定且不受通货膨胀影响的供应量是比特币作为数字稀缺性的价值主张的基石。这一上限通过区块奖励的可预测减半机制来维持，区块奖励是矿工创建新区块的奖励，这也是新比特币的唯一产出方式，所以称为挖矿倒也名副其实。从 2009 年创世区块开始的区块奖励是 50个比特币，然后大约每四年该奖励就会减半，从而确保比特币的发行量呈指数级下降，直至在 2140 年左右达到 2100 万枚的上限。

尽管关于比特币的讨论通常集中在其稀缺性上，2100万枚的严格发行量限制以及每枚比特币的高美元价值，但其基本记账单位却是为微交易而设计的。这个单位是聪（Satoshi，简称sat），它是比特币的最小单位，等于一枚比特币的亿分之一。1 个 BTC 有 100,000,000 聪。这种极高的可分割性意味着，即使一枚比特币的价格大幅上涨，其有效货币单位仍然足够小，可以用于日常交易，从而有效地防止比特币变得过于繁琐或昂贵，无法用于日常支付。使用聪作为基本单位解决了人们在处理高价值货币时产生的心理障碍，同时保持了比特币整体的非通胀特性。假设比特币的价格为每枚十万美元，一杯咖啡八美元。与其将一杯咖啡的价格视为 0.00008 BTC，不如更直观地将其定价为例如 8000 聪。

也可以从全球私人财富总额角度来理解。据[瑞银全球财富报告](https://www.euronews.com/business/2025/08/14/global-personal-wealth-which-countries-have-the-highest-shares-in-europe) 2024 年全球私人净资产总额约为 471 兆（万亿）美元。这里假设私人净资产总额数据为 500 兆美元进行估值。比特币的最大供应量上限为 2100 万枚。尽管许多比特币已经丢失，但仍使用最大供应量进行全球私人财富吸收的理论计算。如果全球每一美元的私人财富都以比特币计价，那么一枚比特币的理论价值约为 2380 万美元。这个数字凸显了比特币固定稀缺性带来的巨大经济影响。届时，记账单位将不再是比特币本身，而是聪（Satoshi），一聪的价值约为0.238美元。届时一杯八美元的咖啡约值 34 聪，仍是个可以接受的货币单位。

至此不得不感叹中本聪的深思熟虑：比特币的总数量与基本记账单位可以让其在全球的操作层面直接实现货币的三个的基本功能：作为全球价值交换媒介、价值存储以及记账单位。比特币既可用于日常消费的小额支付，也可用于大型机构转账。

## 5.3 交易经济学：手续费

与控制供应量的参数不同，交易手续费并非固定变量，而是一个动态的、由市场驱动的价格。当用户创建交易时，手续费的计算方法是：用户消耗的输入（UTXO）总价值与其新输出（收款人和找零）总价值之差。剩余金额由成功挖矿的矿工获得。由于区块空间受区块大小参数的限制，用户之间会通过提供更高的手续费来竞争，以确保他们的交易获得优先处理和快速确认。这种收费机制至关重要，原因有二：一是有效分配稀缺的区块空间，二是长期来看，旨在取代日益减少的区块补贴，作为矿工维护网络安全的主要激励措施。

## 5.4 区块生成时间和大小

比特币公共账本的平稳运行和安全性由两个相互关联的区块生成时间和容量参数决定。首先，协议的设计目标是将目标区块时间维持在 10 分钟。这是一个至关重要的设计权衡：更长的间隔允许新挖出的区块有更多时间在全球范围内传播，从而降低链分叉（同时生成多个区块）的可能性，并提高历史记录的安全性，但代价是交易最终确认速度会变慢。

为了确保在挖矿算力（哈希率）波动的情况下，也能始终达到 10 分钟的挖矿目标，该协议采用了工作量证明（PoW）难度调整机制。该参数每 2016 个区块（大约每两周）动态调整一次。如果在前一个周期内，平均挖矿速度超过 10 分钟，则难度级别会提高，迫使矿工消耗更多算力来寻找下一个有效哈希值。相反，如果挖矿速度过慢，则难度会降低。这种自我纠正机制确保了网络安全的稳健性和区块生成计划的可预测性，不受经济因素的影响，从而保证了矿工的参与度。

当同时生成多个区块的情发生时，最长链规则可以用来解决分歧。因此用户交易的平均确认时间不是单个区块的平均产出时间 10 分钟，而是需要等待交易发生后更多区块产出来减少双花的可能性。通常等待 30 分钟就够了，特别大额的交易等 60 分钟也有了足够的安全保障。

网络的物理容量受到区块大小的限制。历史上区块大小的上限为 1 兆字节 (MB)，此容量限制决定了每个区块的交易数量，通常允许 2,000 到 4,000 笔交易。这一硬性限制造成了区块空间的稀缺性，这对于激励矿工将交易打包进区块以及防止网络垃圾信息至关重要。同较小的尺寸也让存储空间有限的普通个人计算机成为可以存有所有交易的比特币节点。
